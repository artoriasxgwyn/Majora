<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Formulario con Textarea</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
</head>

<body>
    <div class="contenedor">
        <section id="cajaIzquierda">
            <div class="formulario">
                <input type="search" name="busqueda" class="custom" placeholder="Nombre Mascota" autocomplete="name" />
                <input type="text" placeholder="Propietario" autocomplete="name" />
                <input type="text" placeholder="Telefono" />
                <input type="date" placeholder="Fecha Cita" />
                <input type="time" placeholder="Hora Cita" />
                <select name="" id="tipoMascota">
                    <option value="">Especie Mascota</option>
                    <option value="Abierta">Gato</option>
                    <option value="">Perro</option>
                    <option value="">Vaca</option>
                    <option value="">Caballo</option>
                    <option value="">Cuervo</option>
                </select>
                <textarea id="textarea" placeholder="  Sintomas del animal" spellcheck="true"></textarea>
                <button id="save" name="guardar"><i id="" class="fa-solid fa-floppy-disk"
                        style="font-size: 17px;"></i></button>
            </div>
        </section>

        <div class="citacartas" id="citacartas">
            <section class="cajaCitas">
                <div class="webName">
                    <h1>Administrador de Citas</h1>
                </div>
                <div class="box1">
                    <select name="" id="buscarFiltro">
                        <option value="">Buscar/Filtro</option>
                        <option value="Abierta">Abierta</option>
                        <option value="">ads</option>
                        <option value="">ads</option>
                    </select>
                    <button id="botonCita"><i id="icon" class="fa-solid fa-plus" style="font-size: 17px;"></i></button>
                </div>
            </section>
            <section class="cajaCartas"></section>
        </div>
    </div>
</body>
<script>
    let n = 0;
    let datosMesa = [];
    let mesaencontrada = {};
    let modo = 0;
    let numMesa = 0;
    let num = 0;
    let VoF = 1;
    let num1 = "";
    let mesas = [];
    let modal = document.getElementById("modal")
    let buscar = document.getElementById("buscarmesa")
    let citaCartas = document.getElementById("citacartas")

    let boton = document.getElementById("botonCita")
    boton.addEventListener("click", () => {
        const elemento = document.getElementById('cajaIzquierda');

        if (n === 0) {
            document.getElementById("icon").className = "fa-solid fa-minus";
            elemento.style.display = "block";
            citaCartas.style.width = "95%";
            citaCartas.classList.add("scale-up-horizontal-left")
            elemento.classList.add("scale-up-center")
            n = 1;
        } else if (n === 1) {
            document.getElementById("icon").className = "fa-solid fa-plus";
            citaCartas.style.width = "100%";
            citaCartas.classList.remove("scale-up-horizontal-left")
            citaCartas.classList.add("scale-up-horizontal-right")
            elemento.classList.remove("scale-up-center")
            elemento.classList.add("scale-down-center")

            setTimeout(() => {
                elemento.style.display = "none"
            }, 400)
            n = 0;
        };
    }

    )


    function modalalertas(err) {
        modal.textContent = err
        modal.style.backgroundImage = "url('https://i.pinimg.com/736x/2d/84/11/2d8411cdb9438b8dd5c9e954fa4f8e9a.jpg')";
        modal.style.backgroundPosition = "center"
        modal.style.backgroundRepeat = "no-repeat"
        modal.style.width = "40%"
        modal.style.height = "70%"
        modal.style.textAlign = "center"
        modal.style.color = "white"
        modal.style.fontSize = "20px"
        setTimeout(() => {
            modal.style = "hidden"
            modal.textContent = ""
        }, 2000)
    }

    buscar.addEventListener("input", () => {
        console.log(datosMesa.length)
        if (datosMesa.length > 0) {
            datosMesa.forEach((propiedad, indice) => {
                num1 = document.getElementById("buscarmesa").value
                num = parseInt(document.getElementById("buscarmesa").value)
                if (propiedad.numero == num) {
                    VoF = 0
                    mesaencontrada = propiedad
                    console.log(propiedad)
                    modalalertas("mesa encontrada")
                    pintarMesas()
                } else if (indice == datosMesa.length) {
                    console.log(num)
                    console.log(propiedad.numero)
                    modalalertas("no hay mesas registradas con ese numero")
                }
            })
        } else {
            modalalertas("no hay mesas registradas aun")
            pintarMesas()
        }
        if (num1.length == 0) {
            pintarMesas()
        }

    })

    function validaciones(bool) {
        let llave = 1;
        if (modo == 0) {
            datosMesa.forEach((propiedad) => {
                if ((parseInt(document.getElementById("nro").value)) == propiedad.numero) {
                    llave = 0
                    modalalertas("ese numero de mesa ya existe")
                }
            })
        }

        if (document.getElementById("nro").value == "" || true == isNaN(parseInt(document.getElementById("nro").value))) {
            modalalertas("Por favor digite el numero")
        } else if (document.getElementById("descripcion").value == "") {
            modalalertas("Por favor digite la descripcion")
        } else if (document.getElementById("personas").value == "" || true == isNaN(parseInt(document.getElementById("personas").value))) {
            modalalertas("Por favor digite la capcidad de la mesa")
        } else if (document.getElementById("estado").value == "") {
            modalalertas("Por favor digite el estado de la mesa")
        } else if (llave == 1) {
            mesa = {
                numero: document.getElementById("nro").value,
                descripcion: document.getElementById("descripcion").value,
                personas: document.getElementById("personas").value,
                estado: document.getElementById("estado").value,
            }
            bool(true)
        }

    }
    function guardarMesa() {
        validaciones((bool) => {
            if (bool) {
                datosMesa.unshift(mesa)
                modalalertas("Registro exitoso")
                limpiar()
                pintarMesas()
            }
        })
    }

    function limpiar() {
        document.getElementById("nro").value = ""
        document.getElementById("descripcion").value = ""
        document.getElementById("personas").value = ""
        document.getElementById("estado").value = ""
    }

    function editarMesa() {
        validaciones((bool) => {
            if (bool) {
                let indice = datosMesa.findIndex(it => it.numero == numMesa)
                console.log(indice);
                datosMesa[indice].numero = document.getElementById("nro").value
                datosMesa[indice].descripcion = document.getElementById("descripcion").value
                datosMesa[indice].personas = document.getElementById("personas").value
                datosMesa[indice].estado = document.getElementById("estado").value
                pintarMesas()
                modo = 0
                document.getElementById("registrar").textContent = "Guardar Mesa"
                limpiar()
                modalalertas("Registro editado")
            }
        })

    }

    function pintarMesas() {
        document.getElementById("mesas").textContent = ""
        console.log(VoF)
        if (VoF == 1) {
            mesas = datosMesa
        } else if (VoF == 0) {
            mesas = []
            mesas.push(mesaencontrada)
        }
        mesas.forEach((item, i) => {
            let divCard = document.createElement("div")
            let divImagen = document.createElement("div")
            let imagen = document.createElement("img")
            let divTextos = document.createElement("div")
            let parrafoDescripcion = document.createElement("p")
            let numeroMesa = document.createElement("span")
            let divBotones = document.createElement("div")
            let editar = document.createElement("button")
            let eliminar = document.createElement("button")

            divCard.id = "divCard"
            imagen.id = "mesa"
            numeroMesa.textContent = item.numero
            parrafoDescripcion.textContent = item.descripcion
            editar.textContent = "ðŸ“"
            eliminar.textContent = "âŒ"
            imagen.src = "https://i.pinimg.com/736x/00/21/25/0021259a98567d617c162e3ef7cf4238.jpg"

            document.getElementById("mesas").appendChild(divCard)
            divImagen.appendChild(imagen)
            divCard.appendChild(divImagen)
            divCard.appendChild(divTextos)
            divCard.appendChild(divBotones)
            divTextos.appendChild(parrafoDescripcion)
            divTextos.appendChild(numeroMesa)
            divBotones.appendChild(editar)
            divBotones.appendChild(eliminar)

            editar.addEventListener("click", () => {
                document.getElementById("nro").value = item.numero
                document.getElementById("descripcion").value = item.descripcion
                document.getElementById("personas").value = item.personas
                document.getElementById("estado").value = item.estado
                document.getElementById("registrar").textContent = "Editar Mesa"
                modo = 1
                numMesa = item.numero
                VoF = 1
            })

            eliminar.addEventListener("click", () => {
                //findIndex nos permite traer el indice de acuerdo a una condicion
                if (modo == 0) {
                    let indice = datosMesa.findIndex(it => it.numero == item.numero)
                    console.log(indice);
                    datosMesa.splice(indice, 1)
                    console.log(datosMesa);
                    pintarMesas()
                    modalalertas("Registro eliminado")
                }
            })

            if (item.estado == "reservado") {
                divCard.style.backgroundColor = "gray";
            } else if (item.estado == "ocupado") {
                divCard.style.backgroundColor = "green";
            } else {
                divCard.style.backgroundColor = "white";
            }
            VoF = 1
        })
    }

</script>
<style>
    * {
        margin: 0px;
        padding: 0px;
        box-sizing: border-box;
        font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
    }

    h1 {
        font-size: 30px;
        color: #ecf0f1;
    }

    .box1 button {
        border-radius: 20px;
        padding: 10px;
        display: flex;
        align-items: center;
        border: solid 2px #34495e;
        height: 65%;
        background-color: #1b2631;
        color: #ecf0f1;
    }

    .box1 button:hover {
        background-color: #283747;
    }

    body::-webkit-scrollbar {
        display: none;
    }

    select {
        border: solid 2px #34495e;
        border-radius: 20px;
        height: 65%;
        font-weight: bold;
        background-color: #1b2631;
        color: #ecf0f1;
    }

    .formulario {
        padding-top: 5%;
        padding-bottom: 5%;
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        row-gap: 10px;
        height: 100%;
    }

    #textarea {
        flex-grow: 1;
        width: 96%;
        border-radius: 20px;
        border: solid 2px #34495e;
        background-color: #1b2631;
        color: #ecf0f1;
    }

    .formulario select {
        width: 96%;
        height: min-content;
        padding: 5px;
        border-radius: 14px;
        border: solid 2px #34495e;
        background-color: #1b2631;
        color: #ecf0f1;
    }

    .formulario input {
        padding: 5px;
        width: 96%;
        border-radius: 14px;
        border: solid 2px #34495e;
        background-color: #1b2631;
        color: #ecf0f1;
    }

    .box1 {
        display: flex;
        height: 50%;
        align-items: center;
        justify-content: center;
        gap: 6px;
        height: 100%;
        margin-right: 6px;
    }

    .citacartas {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        justify-content: space-between;
        width: 100%;
        gap: 1.3%;
    }

    body {
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #1b2631;
    }

    #cajaIzquierda {
        display: none;
        background-color: #283747;
        width: 20%;
        height: 100%;
        border-radius: 20px;
    }

    .cajaCitas {
        width: 100%;
        height: 8%;
        background-color: #34495e;
        border-radius: 20px;
        display: flex;
        justify-content: flex-end;
    }

    .cajaCartas {
        background-color: #34495e;
        width: 100%;
        height: 91.3%;
        border-radius: 20px;
    }

    button {
        border-radius: 20px;
        padding: 10px;
        display: flex;
        align-items: center;
        border: solid 2px #34495e;
        background-color: #283747;
        color: #ecf0f1;
    }

    .webName {
        padding-left: 10px;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: start;
    }

    .formulario button:hover {
        background-color: #34495e;
    }

    .contenedor {
        background-color: #212f3c;
        width: 93%;
        height: 98vh;
        border-radius: 27.6px;
        padding: 1%;
        display: flex;
        gap: 1%;
    }



    .scale-down-center {
        animation: scale-down-center 0.4s;
    }

    @keyframes scale-down-center {
        0% {
            transform: scale(1)
        }

        100% {
            transform: scale(.5)
        }
    }

    .scale-down-right {
        animation: scale-down-right 0.4s;
    }

    @keyframes scale-down-right {
        0% {
            transform: scale(1);
            transform-origin: right center;
        }

        100% {
            transform: scale(.5);
            transform-origin: right center
        }
    }

    .scale-up-center {
        animation: scale-up-center 0.4s;
    }

    @keyframes scale-up-center {
        0% {
            transform: scale(.5)
        }

        100% {
            transform: scale(1)
        }
    }


    .scale-up-right {
        animation: scale-up-right 0.4s;
    }

    @keyframes scale-up-right {
        0% {
            transform: scale(.5);
            transform-origin: right center
        }

        100% {
            transform: scale(1);
            transform-origin: right center
        }
    }

    /* ----------------------------------------------
  Generated by AnimatiSS
  Licensed under FreeBSD License
  URL: https://xsgames.co/animatiss
  Twitter: @xsgames_
---------------------------------------------- */

    .scale-up-horizontal-right {
        animation: scale-up-horizontal-right 1.2s
    }

    @keyframes scale-up-horizontal-right {
        0% {
            transform: scaleX(.4);
            transform-origin: right center
        }

        100% {
            transform: scaleX(1);
            transform-origin: right center
        }
    }

    /* ----------------------------------------------
  Generated by AnimatiSS
  Licensed under FreeBSD License
  URL: https://xsgames.co/animatiss
  Twitter: @xsgames_
---------------------------------------------- */

    .scale-up-horizontal-left {
        animation: scale-up-horizontal-left 0.4s
    }

    @keyframes scale-up-horizontal-left {
        0% {
            transform: scaleX(.4);
            transform-origin: left center
        }

        100% {
            transform: scaleX(1);
            transform-origin: left center
        }
    }
    
</style>


</html>